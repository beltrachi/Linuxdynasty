<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Latest Posts &#8211; Linuxdynasty</title>
<meta name="description" content="What I am up too.">
<meta name="keywords" content="Python, GoLang, automation, scripting, programming, vFense, metrics, monitoring">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://linuxdynasty.github.io/Linuxdynasty/images/abstract-1.jpg">

<meta name="twitter:title" content="Latest Posts">
<meta name="twitter:description" content="What I am up too.">
<meta name="twitter:creator" content="@linuxdynasty">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Latest Posts">
<meta property="og:description" content="What I am up too.">
<meta property="og:url" content="http://linuxdynasty.github.io/Linuxdynasty/page2/index.html">
<meta property="og:site_name" content="Linuxdynasty">





<link rel="canonical" href="http://linuxdynasty.github.io/Linuxdynasty/page2/">
<link href="http://linuxdynasty.github.io/Linuxdynasty/feed.xml" type="application/atom+xml" rel="alternate" title="Linuxdynasty Feed">
<link rel="author" href="https://google.com/+AllenSanabria?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://linuxdynasty.github.io/Linuxdynasty/assets/css/main.min.css">
<!-- Webfonts -->
<link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://linuxdynasty.github.io/Linuxdynasty/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://linuxdynasty.github.io/Linuxdynasty/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://linuxdynasty.github.io/Linuxdynasty/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://linuxdynasty.github.io/Linuxdynasty/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://linuxdynasty.github.io/Linuxdynasty/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://linuxdynasty.github.io/Linuxdynasty/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://linuxdynasty.github.io/Linuxdynasty/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://linuxdynasty.github.io/Linuxdynasty">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://linuxdynasty.github.io/Linuxdynasty/images/avatar.jpg" alt="Allen Sanabria photo" class="author-photo">
					<h4>Allen Sanabria</h4>
					<p>DevOps developer who loves programming, monitoring, automation, and metrics.</p>
				</li>
				<li><a href="http://linuxdynasty.github.io/Linuxdynasty/about/">Learn More</a></li>
				<li>
					<a href="mailto:asanabria <@> linuxdynasty dot org"><i class="fa fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="http://twitter.com/linuxdynasty"><i class="fa fa-twitter"></i> Twitter</a>
				</li>
				
				<li>
					<a href="https://google.com/+AllenSanabria"><i class="fa fa-google-plus"></i> Google+</a>
				</li>
				<li>
					<a href="http://linkedin.com/in/linuxdynasty"><i class="fa fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="http://github.com/linuxdynasty"><i class="fa fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://linuxdynasty.github.io/Linuxdynasty/posts/">All Posts</a></li>
				<li><a href="http://linuxdynasty.github.io/Linuxdynasty/tags/">All Tags</a></li>
			</ul>
		</li>
		<li><a href="http://linuxdynasty.github.io/Linuxdynasty"></a></li><li><a href="http://linuxdynasty.github.io/Linuxdynasty"></a></li>
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  <div class="image-credit">Image source: <a href="http://www.dargadgetz.com/ios-7-abstract-wallpaper-pack-for-iphone-5-and-ipod-touch-retina/">dargadgetz</a></div><!-- /.image-credit -->
  
    <div class="entry-image">
      <img src="http://linuxdynasty.github.io/Linuxdynasty/images/abstract-1.jpg" alt="Latest Posts">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Linuxdynasty</h1>
      <h2>Latest Posts</h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2012-03-20T03:37:52-04:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/redis/howto-check-redis-availability-stats-redis-py-zenoss-python/">March 20, 2012</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/redis/howto-check-redis-availability-stats-redis-py-zenoss-python/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~3 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/redis/howto-check-redis-availability-stats-redis-py-zenoss-python/" rel="bookmark" title="HowTo check redis availability and get stats using Redis-py, Zenoss, and Python" itemprop="url">HowTo check redis availability and get stats using Redis-py, Zenoss, and Python</a></h1>
    
  </header>
  <div class="entry-content">
    <p>My team was assigned to create a redis slave status check to be ran under Zenoss.
So while they are creating that check, I decided to google for redis checks
written in python that work under Nagios and or Zenoss and none of the checks
i found did exactly what I wanted.</p>

<p>So I decided to write my own check, that will grab every piece of data that the redis info() command was able to retrieve. Since this info is all in a python dictionary, I was able to get all the stats that were labeled as type int or as type float, which made my job that much easier.</p>

<p>So 1st I had to install 2 Redis instances on my local Ubuntu server at home. Now that i completed that, I had to make sure the slave was syncing off the master server. I used this link “<a title="Redis Replication Configuration" href="http://redis.io/topics/replication" target="_blank">http://redis.io/topics/replication</a>” to help me configure redis replication.
Now that all that stuff is out of the way, I wrote an easy_peasy python script to connect to redis and grab all of the performance stats. As well as verify if the instance is a master or a slave instance. If it is a slave instance, than it also verifies if it is syncing to the master or not.
The script is using <a href="https://github.com/andymccurdy/redis-py" target="_blank">Redis-py</a> that was installed using PIP.</p>

<p>Here is the script I wrote</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">godssoldier:python asanabria<span class="nv">$ </span>python ld_check_redis.py -d 127.0.0.1 -p <span class="s1">&#39;t35t_r3d15&#39;</span> -n 6379
OK Master Redis Server 127.0.0.1 is Running 2.4.4 <span class="p">|</span> <span class="nv">pubsub_channels</span><span class="o">=</span><span class="m">0</span> <span class="nv">bgrewriteaof_in_progress</span><span class="o">=</span>0
<span class="nv">connected_slaves</span><span class="o">=</span><span class="m">1</span> <span class="nv">uptime_in_days</span><span class="o">=</span><span class="m">0</span> <span class="nv">lru_clock</span><span class="o">=</span><span class="m">1099413</span> <span class="nv">last_save_time</span><span class="o">=</span><span class="m">1332199497</span> <span class="nv">redis_git_sha1</span><span class="o">=</span>0
<span class="nv">loading</span><span class="o">=</span><span class="m">0</span> <span class="nv">connected_clients</span><span class="o">=</span><span class="m">1</span> <span class="nv">keyspace_misses</span><span class="o">=</span><span class="m">4</span> <span class="nv">used_memory</span><span class="o">=</span><span class="m">939792</span> <span class="nv">vm_enabled</span><span class="o">=</span>0
<span class="nv">used_cpu_user_children</span><span class="o">=</span>0.000000 <span class="nv">used_memory_peak</span><span class="o">=</span><span class="m">939776</span> <span class="nv">total_commands_processed</span><span class="o">=</span>10
<span class="nv">latest_fork_usec</span><span class="o">=</span><span class="m">211</span> <span class="nv">used_memory_rss</span><span class="o">=</span><span class="m">1286144</span> <span class="nv">total_connections_received</span><span class="o">=</span><span class="m">8</span> <span class="nv">pubsub_patterns</span><span class="o">=</span>0
<span class="nv">aof_enabled</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_cpu_sys</span><span class="o">=</span>0.130000 <span class="nv">used_cpu_sys_children</span><span class="o">=</span>0.000000 <span class="nv">blocked_clients</span><span class="o">=</span>0
<span class="nv">used_cpu_user</span><span class="o">=</span>0.120000 <span class="nv">client_biggest_input_buf</span><span class="o">=</span><span class="m">0</span> <span class="nv">db0_keys</span><span class="o">=</span><span class="m">2</span> <span class="nv">db0_expires</span><span class="o">=</span><span class="m">0</span> <span class="nv">arch_bits</span><span class="o">=</span>64
<span class="nv">mem_fragmentation_ratio</span><span class="o">=</span>1.370000 <span class="nv">expired_keys</span><span class="o">=</span><span class="m">0</span> <span class="nv">evicted_keys</span><span class="o">=</span><span class="m">0</span> <span class="nv">bgsave_in_progress</span><span class="o">=</span>0
<span class="nv">client_longest_output_list</span><span class="o">=</span><span class="m">0</span> <span class="nv">process_id</span><span class="o">=</span><span class="m">22007</span> <span class="nv">uptime_in_seconds</span><span class="o">=</span><span class="m">401</span> <span class="nv">changes_since_last_save</span><span class="o">=</span>2
<span class="nv">redis_git_dirty</span><span class="o">=</span><span class="m">0</span> <span class="nv">keyspace_hits</span><span class="o">=</span>1

godssoldier:python asanabria<span class="nv">$ </span>python ld_check_redis.py -d 127.0.0.1 -p <span class="s1">&#39;t35t_r3d15&#39;</span> -n 6390
OK Master 127.0.0.1 is up and Slave 127.0.0.1 is in sync <span class="p">|</span> <span class="nv">pubsub_channels</span><span class="o">=</span><span class="m">0</span> <span class="nv">bgrewriteaof_in_progress</span><span class="o">=</span>0
<span class="nv">connected_slaves</span><span class="o">=</span><span class="m">0</span> <span class="nv">uptime_in_days</span><span class="o">=</span><span class="m">0</span> <span class="nv">lru_clock</span><span class="o">=</span><span class="m">1099413</span> <span class="nv">last_save_time</span><span class="o">=</span><span class="m">1332199497</span> <span class="nv">redis_git_sha1</span><span class="o">=</span>0
<span class="nv">loading</span><span class="o">=</span><span class="m">0</span> <span class="nv">connected_clients</span><span class="o">=</span><span class="m">2</span> <span class="nv">keyspace_misses</span><span class="o">=</span><span class="m">4</span> <span class="nv">used_memory</span><span class="o">=</span><span class="m">939872</span> <span class="nv">master_last_io_seconds_ago</span><span class="o">=</span>8
<span class="nv">vm_enabled</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_cpu_user_children</span><span class="o">=</span>0.000000 <span class="nv">used_memory_peak</span><span class="o">=</span><span class="m">931248</span> <span class="nv">total_commands_processed</span><span class="o">=</span>44
<span class="nv">latest_fork_usec</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_memory_rss</span><span class="o">=</span><span class="m">1277952</span> <span class="nv">total_connections_received</span><span class="o">=</span><span class="m">2</span> <span class="nv">pubsub_patterns</span><span class="o">=</span><span class="m">0</span> <span class="nv">aof_enabled</span><span class="o">=</span>0
<span class="nv">used_cpu_sys</span><span class="o">=</span>0.130000 <span class="nv">used_cpu_sys_children</span><span class="o">=</span>0.000000 <span class="nv">blocked_clients</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_cpu_user</span><span class="o">=</span>0.070000
<span class="nv">master_port</span><span class="o">=</span><span class="m">6379</span> <span class="nv">client_biggest_input_buf</span><span class="o">=</span><span class="m">0</span> <span class="nv">db0_keys</span><span class="o">=</span><span class="m">2</span> <span class="nv">db0_expires</span><span class="o">=</span><span class="m">0</span> <span class="nv">arch_bits</span><span class="o">=</span>64
<span class="nv">mem_fragmentation_ratio</span><span class="o">=</span>1.360000 <span class="nv">expired_keys</span><span class="o">=</span><span class="m">0</span> <span class="nv">evicted_keys</span><span class="o">=</span><span class="m">0</span> <span class="nv">bgsave_in_progress</span><span class="o">=</span><span class="m">0</span> <span class="nv">client_longest_output_list</span><span class="o">=</span>0
<span class="nv">master_sync_in_progress</span><span class="o">=</span><span class="m">0</span> <span class="nv">process_id</span><span class="o">=</span><span class="m">22010</span> <span class="nv">uptime_in_seconds</span><span class="o">=</span><span class="m">398</span> <span class="nv">changes_since_last_save</span><span class="o">=</span><span class="m">2</span> <span class="nv">redis_git_dirty</span><span class="o">=</span>0
<span class="nv">keyspace_hits</span><span class="o">=</span>0

CRITICAL Master 127.0.0.1 is down and Slave 127.0.0.1 is out of sync <span class="p">|</span>
<span class="nv">pubsub_channels</span><span class="o">=</span><span class="m">0</span> <span class="nv">bgrewriteaof_in_progress</span><span class="o">=</span><span class="m">0</span> <span class="nv">connected_slaves</span><span class="o">=</span><span class="m">0</span> <span class="nv">master_link_down_since_seconds</span><span class="o">=</span>1332199283
<span class="nv">uptime_in_days</span><span class="o">=</span><span class="m">0</span> <span class="nv">lru_clock</span><span class="o">=</span><span class="m">1099352</span> <span class="nv">last_save_time</span><span class="o">=</span><span class="m">1332198992</span> <span class="nv">redis_git_sha1</span><span class="o">=</span><span class="m">0</span> <span class="nv">loading</span><span class="o">=</span><span class="m">0</span> <span class="nv">connected_clients</span><span class="o">=</span>1
<span class="nv">keyspace_misses</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_memory</span><span class="o">=</span><span class="m">931040</span> <span class="nv">master_last_io_seconds_ago</span><span class="o">=</span>-1 <span class="nv">vm_enabled</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_cpu_user_children</span><span class="o">=</span>0.000000
<span class="nv">used_memory_peak</span><span class="o">=</span><span class="m">931040</span> <span class="nv">total_commands_processed</span><span class="o">=</span><span class="m">5</span> <span class="nv">latest_fork_usec</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_memory_rss</span><span class="o">=</span>1261568
<span class="nv">total_connections_received</span><span class="o">=</span><span class="m">6</span> <span class="nv">pubsub_patterns</span><span class="o">=</span><span class="m">0</span> <span class="nv">aof_enabled</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_cpu_sys</span><span class="o">=</span>0.080000
<span class="nv">used_cpu_sys_children</span><span class="o">=</span>0.000000 <span class="nv">blocked_clients</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_cpu_user</span><span class="o">=</span>0.030000 <span class="nv">master_port</span><span class="o">=</span>6379
<span class="nv">client_biggest_input_buf</span><span class="o">=</span><span class="m">0</span> <span class="nv">arch_bits</span><span class="o">=</span><span class="m">64</span> <span class="nv">mem_fragmentation_ratio</span><span class="o">=</span>1.360000 <span class="nv">expired_keys</span><span class="o">=</span><span class="m">0</span> <span class="nv">evicted_keys</span><span class="o">=</span>0
 <span class="nv">bgsave_in_progress</span><span class="o">=</span><span class="m">0</span> <span class="nv">client_longest_output_list</span><span class="o">=</span><span class="m">0</span> <span class="nv">master_sync_in_progress</span><span class="o">=</span><span class="m">0</span> <span class="nv">process_id</span><span class="o">=</span>21887
<span class="nv">uptime_in_seconds</span><span class="o">=</span><span class="m">290</span> <span class="nv">changes_since_last_save</span><span class="o">=</span><span class="m">0</span> <span class="nv">redis_git_dirty</span><span class="o">=</span><span class="m">0</span> <span class="nv">keyspace_hits</span><span class="o">=</span>0</code></pre></div>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2011-12-30T22:26:23-05:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/monitor-rtsp-streaming-videos-openrtsp-zenoss/">December 30, 2011</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/monitor-rtsp-streaming-videos-openrtsp-zenoss/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/monitor-rtsp-streaming-videos-openrtsp-zenoss/" rel="bookmark" title="How To monitor RTSP streaming videos using openRTSP and Zenoss" itemprop="url">How To monitor RTSP streaming videos using openRTSP and Zenoss</a></h1>
    
  </header>
  <div class="entry-content">
    <p>Since I do currently work for a streaming company, that would imply that we should have some type of monitoring for our RTSP streams ;-). You will 1st need to get the openRTSP command.</p>
<ul>
<li>You will need to download the openRTSP command from http://www.live555.com/openRTSP/</li>
<li>Or if you are running Zenoss on top of Debian you can just run a apt-get install livemedia-utils</li>
</ul>
<p>Once you do that, all you have to do next is to download my script and have a valid server to point at and a path to test... Example below.. {filelink=24}</p>
<pre>./check_rtsp.py -d remote_server -p /iphone/2012 
OK /iphone/2012, test completed successfull against remote_server |status=0</pre>
<p>or with stats...</p>
<pre>./check_rtsp.py -d remote_server -p /iphone/2012 -s
OK /iphone/2012, test completed successfull against remote_server |status=0 num_packets_received=16 num_packets_lost=0 elapsed_measurement_time=3.000073 kBytes_received_total=16.309000 
measurement_sampling_interval_ms=1000 kbits_per_second_min=29.245485 kbits_per_second_ave=43.489608 
kbits_per_second_max=51.737449 packet_loss_percentage_min=0.000000 packet_loss_percentage_ave=0.000000 
packet_loss_percentage_max=0.000000 inter_packet_gap_ms_min=0.018000 inter_packet_gap_ms_ave=161.139313 
inter_packet_gap_ms_max=901.439000 subsession=video/H264 num_packets_received=61 num_packets_lost=0 
elapsed_measurement_time=3.000073 kBytes_received_total=27.630000 measurement_sampling_interval_ms=1000 
kbits_per_second_min=0.000000 kbits_per_second_ave=73.678207 kbits_per_second_max=122.923442 
packet_loss_percentage_min=0.000000 packet_loss_percentage_ave=0.000000 packet_loss_percentage_max=0.000000 
inter_packet_gap_ms_min=0.009000 inter_packet_gap_ms_ave=24.794672 inter_packet_gap_ms_max=528.923000</pre>
<p>So you can trend the different stats that openRTSP provides in Zenoss..</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2011-12-28T21:27:47-05:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/snmp/monitor-bind-9-stats-zenoss/">December 28, 2011</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/snmp/monitor-bind-9-stats-zenoss/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~2 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/snmp/monitor-bind-9-stats-zenoss/" rel="bookmark" title="How To Monitor and get Bind 9 stats using Zenoss" itemprop="url">How To Monitor and get Bind 9 stats using Zenoss</a></h1>
    
  </header>
  <div class="entry-content">
    <p>Hey guys, here is another Python script by me :-) . The reason for this script, is to give you the capabilities to monitor and graph Bind 9 stats. This script will be executed through SNMP.. We will be using the UCD-MIB 1.3.6.1.4.1.2021.8.1</p>
<pre>The stats are from named.stats... Here is an example of named.stats..
cat /var/cache/bind/named.stats
+++ Statistics Dump +++ (1325089261)
++ Incoming Requests ++
            83318718 QUERY
++ Incoming Queries ++
            54293282 A
                1929 NS
                3186 CNAME
                  27 SOA
            13645272 PTR
                7921 MX
                 781 TXT
            15224426 AAAA
                 200 SRV
                   1 NAPTR
                1271 A6
                  95 DS
                   2 NSEC
                  66 SPF
              140257 ANY
                   2 Others</pre>
<p>You can download the script here .. {filelink=23}</p>
<p><a id="more"></a><a id="more-415"></a><br />
I purposely made this script so that it can be used with snmpd.conf. I made an option called '<strong>-g</strong>', and this option will actualy generate the snmpd.conf file for you with the entries that can be monitored. Example below..</p>
<pre>exec ResolverStatisticsqueries-with-RTT---1600ms /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'queries with RTT &gt; 1600ms'
exec ResolverStatisticsqueries-with-RTT-800-1600ms /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'queries with RTT 800-1600ms'
exec ResolverStatisticsqueries-with-RTT-10-100ms /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'queries with RTT 10-100ms'
exec ResolverStatisticsSERVFAIL-received /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'SERVFAIL received'
exec ResolverStatisticsother-errors-received /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'other errors received'
exec ResolverStatisticsquery-timeouts /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'query timeouts'
exec ResolverStatisticsIPv4-responses-received /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'IPv4 responses received'
exec ResolverStatisticsqueries-with-RTT-500-800ms /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'queries with RTT 500-800ms'
exec ResolverStatisticsqueries-with-RTT---10ms /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'queries with RTT &lt; 10ms'
exec ResolverStatisticsqueries-with-RTT-100-500ms /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'queries with RTT 100-500ms'
exec ResolverStatisticsIPv4-queries-sent /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'IPv4 queries sent'
exec ResolverStatisticsIPv4-NS-address-fetches /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'IPv4 NS address fetches'
exec ResolverStatisticsEDNS(0)-query-failures /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'EDNS(0) query failures'
exec ResolverStatisticsquery-retries /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'query retries'
exec ResolverStatisticslame-delegations-received /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'lame delegations received'
exec ResolverStatisticsFORMERR-received /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'FORMERR received'
exec ResolverStatisticsNXDOMAIN-received /usr/local/bin/getBindStats.py -t 'Resolver Statistics' -s 'NXDOMAIN received'</pre>
<p>That is just a sample above as there is a lot more data from the original output. Here is the output with the '<strong>-h</strong>' option..</p>
<pre>/usr/local/bin/getBindStats.py -h
Usage: getBindStats.py arg --grouptype='Incoming Requests' --printstat='A'

Options:
  -h, --help            show this help message and exit
  -t GTYPE, --grouptype=GTYPE
                        Cache DB RRsets,Incoming Queries,Incoming
                        Requests,Name Server Statistics,Outgoing
                        Queries,Resolver Statistics,Socket I/O Statistics,Zone
                        Maintenance Statistics
  -s PRINT_STAT, --printstat=PRINT_STAT
                        Acceptable Values are these:::TXT,PTR,SPF,queries
                        caused recursion,A,IPv4 NS address fetch
                        failed,mismatch responses received,TCP/IPv4
                        connections established,queries with RTT
                        100-500ms,query timeouts,query retries,NSEC,IPv4
                        responses received,requests with EDNS(0)
                        received,TCP/IPv4 sockets closed,IPv4 IXFR
                        requested,SRV,NOTIFY,queries with RTT
                        10-100ms,TCP/IPv4 connections accepted,lame
                        delegations received,FORMERR received,RRSIG,queries
                        with RTT &gt; 1600ms,UDP/IPv4 recv errors,NS,IPv4
                        notifies sent,queries with RTT 800-1600ms,SERVFAIL
                        received,IPv4 AXFR requested,auth queries
                        rejected,ANY,IPv4 requests received,queries with RTT &lt;
                        10ms,IPv4 notifies received,IPv4 queries sent,queries
                        resulted in referral answer,NXDOMAIN,other errors
                        received,QUERY,truncated responses received,MX,TCP
                        requests received,
  -g, --gensnmp         This will generate in STDOUT the SNMP info you need in
                        snmpd.conf</pre>
<p>&nbsp;</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2011-12-28T00:31:28-05:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/howto/nodejs/monitor-nodejs-stats-plugin-cluster-zenoss/">December 28, 2011</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/howto/nodejs/monitor-nodejs-stats-plugin-cluster-zenoss/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/howto/nodejs/monitor-nodejs-stats-plugin-cluster-zenoss/" rel="bookmark" title="How To monitor NodeJS using the Stats plugin that comes with Cluster using Zenoss." itemprop="url">How To monitor NodeJS using the Stats plugin that comes with Cluster using Zenoss.</a></h1>
    
  </header>
  <div class="entry-content">
    <p>We needed a way to monitor all of our NodeJS instances in Zenoss and not just a simple TCP connection. Since we were already using the Cluster plugin for NodeJS 'http://learnboost.github.com/cluster/' and we are using the stats plugin for Cluster 'http://learnboost.github.com/cluster/docs/stats.html'. We decided to write a quick python script to connect to the stats plugin and parse that data to represent it to Zenoss.</p>
<p>You have 2 options... Run this script by itself using Zenoss to connect to the host or if you are using a socket connection or connecting to localhost only then use SNMP.</p>
<p>Download Here .. {filelink=22}</p>
<ul>
<li>( IN SNMP ) Options are modifiable <strong>'exec CheckClusterLiveStats /usr/local/bin/check_clusterlive_stats.py -t tcp -c localhost:8888</strong>'</li>
<li>Or directly in Zenoss '<strong>/usr/local/bin/check_clusterlive_stats.py -t tcp -c remotehost:8888'</strong></li>
</ul>
<p>This script can be used to connect to a TCP socket or to a local file socket. Example output from Zenoss Test Command...</p>
<pre>Using SNMP Preparing Command...
Executing command /usr/local/zenoss/libexec/check_snmp -H 127.0.0.1 -o .1.3.6.1.4.1.8072.1.3.2.3.1.1.21.67.104.101.99.107.67.108.117.115.116.101.114.76.105.118.101.83.116.97.116.115 -C readonly -R OK against 127.0.0.1
SNMP OK - "Deaths Has not increased, Deaths count is 0 NodeJS cluster OK |restarts=0 workers=4 deaths=0 connections_total=193463 connections_active=0" |

Using Command only...</pre>
<pre>Preparing Command...
Executing command /usr/local/zenoss/libexec/check_clusterlive_stats.py -t tcp -c remotehost:8888
"Deaths Has not increased, Deaths count is 0 NodeJS cluster OK |restarts=0 workers=4 deaths=0 connections_total=193463 connections_active=0" |</pre>
<p>The command above you can run with out snmp. The reason we use snmp because we only allow the stats plugin to run on the localhost interface. So we use snmp to execute the script and in return, it returns the results.</p>
<pre>Here is the help output..
check_clusterlive_stats.py -h
Usage: check_clusterlive_stats.py arg --contype=socket|tcp --connection=pathto socket|host:port

Options:
  -h, --help            show this help message and exit
  -t CONTYPE, --contype=CONTYPE
                        socket or tcp
  -c CONNECTION, --connection=CONNECTION
                        /tmp/cluster-repl.sock or localhost:8888
  -w TIMEOUT, --timeout=TIMEOUT
                        int of how long you want this script to wait until it
                        times out</pre>
<p>&nbsp;</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2011-12-27T19:52:04-05:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/howto/monitor-http-status-codes-zenoss-snmp/">December 27, 2011</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/howto/monitor-http-status-codes-zenoss-snmp/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/howto/monitor-http-status-codes-zenoss-snmp/" rel="bookmark" title="How To Monitor Http Status Codes using Zenoss and Snmp." itemprop="url">How To Monitor Http Status Codes using Zenoss and Snmp.</a></h1>
    
  </header>
  <div class="entry-content">
    <p>We needed a way to monitor a few different type of HTTP Status Codes, specifically... ( 400, 404, 500, 503, 504, 200 ). This list is modifiable within the script. Though I'm thinking of turning this list into an option, since everyone might not one to gather the count just for those mentioned above.</p>
<p>So In order to get this data, you will need to use SNMP and install logtail. To make this script work you will need to have an snmpd exec statement in the snmpd.conf file and a crontab entry for the script to run as often as you like.</p>
<p>This script has been tested, using Nginx and Ruby On Rails.<br />
You can download the script here.. {filelink=21}</p>
<ul>
<li>On cron, remember this is modifiable '<strong>* * * * * /usr/local/bin/get_http_codes.py -d "/var/log/nginx" -f "www-access.log" &gt;/tmp/errorcount.txt'</strong></li>
<li>In snmpd.conf without quotes '<strong>exec GetHttpStats /bin/cat /tmp/errorcount.txt</strong>'</li>
</ul>
<p>In Zenoss you will have to use the check_snmp nagios command or the inherent snmp check from zenoss. The oid you need to use is the UCDavis OID. For instance I'm using 2 exec statements in snmpd.conf, so the OID I am using for this check is this one '<strong>.1.3.6.1.4.1.2021.8.1.101.2</strong>' The command I'm using in zenoss is like this <strong>'check_snmp -H ${dev/manageIp} -C readonly -P 2c -o .1.3.6.1.4.1.2021.8.1.101.2</strong>'</p>
<p>The current options for get_http_codes.py is '<strong>-d</strong>' which is the directory where the log file is located and '<strong>-f</strong> ' the name of the logfile. This script uses logtail so that I can always get the difference from the last time I scanned the log file.</p>
<p>The purpose of this script is so that you can graph or create a threshold of how many of the below Http Error Codes you are getting between every check. For instance we run this check every 30 seconds in Cron and in Zenoss and we divide the results by 30 so we can get how many of the error codes are happening per second.<br />
Example of the output of the script is 'SNMP OK - "<strong>Nginx Codes OK|count200=181 count400=1 count404=0 count500=0 count503=0 count504=0" |</strong> '</p>
<p>If you have any feature request or have any questions, please leave a comment. Thank you</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->


<div class="pagination">
  
    
      <a href="http://linuxdynasty.github.io/Linuxdynasty" class="btn">Previous</a>
    
  
  <ul class="inline-list">
    <li>
      
        <a href="http://linuxdynasty.github.io/Linuxdynasty">1</a>
      
    </li>
    
      <li>
        
          <span class="current-page">2</span>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page3">3</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page4">4</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page5">5</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page6">6</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page7">7</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page8">8</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page9">9</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page10">10</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page11">11</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page12">12</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page13">13</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page14">14</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page15">15</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page16">16</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page17">17</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page18">18</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page19">19</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page20">20</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page21">21</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page22">22</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page23">23</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page24">24</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page25">25</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page26">26</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page27">27</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page28">28</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page29">29</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page30">30</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page31">31</a>
        
      </li>
    
  </ul>
  
    <a href="http://linuxdynasty.github.io/Linuxdynasty/page3" class="btn">Next</a>
  
</div><!-- /.pagination -->

</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 Allen Sanabria. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://linuxdynasty.github.io/Linuxdynasty/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://linuxdynasty.github.io/Linuxdynasty/assets/js/scripts.min.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2333243-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>

          

</body>
</html>