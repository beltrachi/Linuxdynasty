<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Latest Posts &#8211; Linuxdynasty</title>
<meta name="description" content="What I am up too.">
<meta name="keywords" content="Python, GoLang, automation, scripting, programming, vFense, metrics, monitoring">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://linuxdynasty.github.io/Linuxdynasty/images/abstract-1.jpg">

<meta name="twitter:title" content="Latest Posts">
<meta name="twitter:description" content="What I am up too.">
<meta name="twitter:creator" content="@linuxdynasty">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Latest Posts">
<meta property="og:description" content="What I am up too.">
<meta property="og:url" content="http://linuxdynasty.github.io/Linuxdynasty/page7/index.html">
<meta property="og:site_name" content="Linuxdynasty">





<link rel="canonical" href="http://linuxdynasty.github.io/Linuxdynasty/page7/">
<link href="http://linuxdynasty.github.io/Linuxdynasty/feed.xml" type="application/atom+xml" rel="alternate" title="Linuxdynasty Feed">
<link rel="author" href="https://google.com/+AllenSanabria?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://linuxdynasty.github.io/Linuxdynasty/assets/css/main.min.css">
<!-- Webfonts -->
<link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://linuxdynasty.github.io/Linuxdynasty/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://linuxdynasty.github.io/Linuxdynasty/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://linuxdynasty.github.io/Linuxdynasty/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://linuxdynasty.github.io/Linuxdynasty/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://linuxdynasty.github.io/Linuxdynasty/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://linuxdynasty.github.io/Linuxdynasty/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://linuxdynasty.github.io/Linuxdynasty/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://linuxdynasty.github.io/Linuxdynasty">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://linuxdynasty.github.io/Linuxdynasty/images/avatar.jpg" alt="Allen Sanabria photo" class="author-photo">
					<h4>Allen Sanabria</h4>
					<p>DevOps developer who loves programming, monitoring, automation, and metrics.</p>
				</li>
				<li><a href="http://linuxdynasty.github.io/Linuxdynasty/about/">Learn More</a></li>
				<li>
					<a href="mailto:asanabria <@> linuxdynasty dot org"><i class="fa fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="http://twitter.com/linuxdynasty"><i class="fa fa-twitter"></i> Twitter</a>
				</li>
				
				<li>
					<a href="https://google.com/+AllenSanabria"><i class="fa fa-google-plus"></i> Google+</a>
				</li>
				<li>
					<a href="http://linkedin.com/in/linuxdynasty"><i class="fa fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="http://github.com/linuxdynasty"><i class="fa fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://linuxdynasty.github.io/Linuxdynasty/posts/">All Posts</a></li>
				<li><a href="http://linuxdynasty.github.io/Linuxdynasty/tags/">All Tags</a></li>
			</ul>
		</li>
		<li><a href="http://linuxdynasty.github.io/Linuxdynasty"></a></li><li><a href="http://linuxdynasty.github.io/Linuxdynasty"></a></li>
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  <div class="image-credit">Image source: <a href="http://www.dargadgetz.com/ios-7-abstract-wallpaper-pack-for-iphone-5-and-ipod-touch-retina/">dargadgetz</a></div><!-- /.image-credit -->
  
    <div class="entry-image">
      <img src="http://linuxdynasty.github.io/Linuxdynasty/images/abstract-1.jpg" alt="Latest Posts">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Linuxdynasty</h1>
      <h2>Latest Posts</h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2009-09-26T23:11:22-04:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/blog/python-and-expect/">September 26, 2009</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/blog/python-and-expect/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/blog/python-and-expect/" rel="bookmark" title="Python and Expect" itemprop="url">Python and Expect</a></h1>
    
  </header>
  <div class="entry-content">
    <div>At the current place that I work at, we are trying to figure out, how much we are logging on a daily basis. Since my manager is thinking of purchasing Splunk ( I hope he does ). But before we make that leap and spend that much money ( Those of you who have splunk know exactly what I am talking about ). We need to know how much we are logging now and how much we would be logging after all of our devices are in Splunk.</div>
<p>The current issue is that we have over 400 Cisco Network devices, and they are not all in the Cisco LMS ( Lan Management Solution ). We also have Solarwind, but we do not have all of our Networking devices in there either. There is only one way I know of doing that with out using multiple tools like Cisco LMS or Func. So I figured, I should go ahead and write a Python tool that can update all of our devices ( Cisco, Nortel, Foundry,Â  Linux, BSD, you get the idea.. ).</p>
<p>I wrote a Python tool that utilizes pexpect. The tools is almost complete to release on my site, but I still need to add more functionality. Currently, you can pass a device list and a command list to the script. You can also tell the tool to be verbose and print the output. Also you can tell it to use ssh or telnet or both. The tool is smart enogh to use ssh keys or log into a device you never have logged into before, by accepting the key for you.</p>
<p>I'm currently modifying it so that you can just pass one device and not just a list of devices. Also working on a password changer function. I've tested my tool on Linux Servers as well as Cisco devices and so far it works like a charm. I'm thinking about adding threading, but I have not yet decided to do so..</p>
<div>I will post this tool either tonight or tomorrow.. I hope you will find this tool as useful as we do.</div>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2009-09-18T11:24:27-04:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/uncategorized/ld-port-report-112-update-aka-the-host-and-mac-reporting-tool/">September 18, 2009</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://linuxdynasty.github.io/Linuxdynasty/uncategorized/ld-port-report-112-update-aka-the-host-and-mac-reporting-tool/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~2 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/uncategorized/ld-port-report-112-update-aka-the-host-and-mac-reporting-tool/" rel="bookmark" title="LD Port Report 1.12 update aka the Host and MAC Reporting tool" itemprop="url">LD Port Report 1.12 update aka the Host and MAC Reporting tool</a></h1>
    
  </header>
  <div class="entry-content">
    <div>
<div>We are happy to announce the release of Port Report 1.12. In this release, we can now follow CDP Neighbors while using the <strong>--report</strong> or <strong>-r</strong> options. Before when you used the <strong>--report</strong> option, the script will report on just that one switch. Now if you pass the <strong>--follow</strong> or <strong>-f </strong>option with the <strong>--report</strong> or <strong>-r</strong> option, port_report will follow the CDP neighbors and create multiple CSV files.<br />
Release notes are below.... If you want to see an example of the Port Report output and how to run it, please check this link</div>
<div>LD Port Report == {filelink=15}<br />
..<a href="ld-port-report-project.html">http://www.linuxdynasty.org/ld-port-report-project.html</a>
</div>
<div>
<dl>
<dd>Revision 1.12 09/18/09
<ul>
<li>The report option of the script can now follow cdp neighbors using the <strong>--follow</strong> option or <strong>-f</strong>.<br />
When you run the command below it will create ONE CSV file per cdp neighbor it scanned.<br />
I was able to scan from my core Switch down to the last neighbor in the line ( 44 Neighbors in just under 20 minutes. )<br />
Which equaled to a little over 4K Mac Addresses<br />
For instance...port_report.py -d 192.168.101.1 -c public -r -f</li>
</ul>
<p><a id="more"></a><a id="more-212"></a></p>
<p>Revision 1.11 09/13/09</p>
<ul>
<li>More code clean up and another increase in speed.</li>
<li>Also port_report can now follow EtherChannel</li>
<li>Fixed issue, where the matching of the cdp neighbor was not matching correctly</li>
<li>Added better verbosity</li>
<li>Added Sanity Checking for cdp neighbors</li>
</ul>
<p>Revision 1.10 09/09/09</p>
<ul>
<li>Code Clean up and a slight increase in speed ( by a few seconds ) during the search by mac or ip</li>
</ul>
<p>Revision 1.9<br />
Code changes and Added CDP Support</p>
<ul>
<li>Detect CDP Neighbors during the scan for MAC Addresses or IP Addresses</li>
</ul>
<p>Revision 1.8<br />
Here is a quick update.....</p>
<ul>
<li>I just add dns reverse lookups to the output of this script.</li>
</ul>
<p>Revision 1.7<br />
Adds support to the following devices..</p>
<ol>
<li>Cisco
<ul>
<li>Catalyst 6509 w/ Supervisor 720 running IOS</li>
<li>Catalyst 3560</li>
<li>Catalyst 3550 (SMI)</li>
<li>Cisco CIGESM series Chassis Blades</li>
<li>Cisco Catalyst 2960</li>
</ul>
</li>
<li>Foundry
<ul>
<li>Foundry Server Iron</li>
</ul>
</li>
<li>Nortel
<ul>
<li>Nortel Passport 8600</li>
<li>Nortel 5520 Ethernet Routing Switch</li>
</ul>
</li>
<li>HP
<ul>
<li>HP Procurve 5406xl</li>
</ul>
</li>
</ol>
<p>&nbsp;</p>
<p>Revision 1.6<br />
New additions to this revision ....</p>
<ul>
<li>Support for HP Procurve Switches, ( Tested on the newer versions of HP )</li>
<li>combined switch_report.py in port_report.py.</li>
<li>Added --verbose flag</li>
</ul>
<p>Previous Releases....</p>
<ul>
<li>Search by MAC or IP or PORT</li>
</ul>
</dd>
</dl>
</div>
</div>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2009-09-15T13:58:17-04:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/uncategorized/ld-port-report-111-update/">September 15, 2009</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://linuxdynasty.github.io/Linuxdynasty/uncategorized/ld-port-report-111-update/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/uncategorized/ld-port-report-111-update/" rel="bookmark" title="LD Port Report 1.11 update" itemprop="url">LD Port Report 1.11 update</a></h1>
    
  </header>
  <div class="entry-content">
    <div>We are happy to announce the release of Port Report 1.11. In this release, we have fixed quite a few bugs that were in the previous release. Included in this release is the ability to follow EtherChannel aka PortChannel Ports using the Port Agreggation Protocol.<br />
Release notes are below.... If you want to see an example of the Port Report output and how to run it, please check this link</div>
<div>LD Port Report == {filelink=15}</div>
<div>..<a href="ld-port-report-project.html">http://www.linuxdynasty.org/ld-port-report-project.html</a>
</div>
<div>
<dl>
<dd>Revision 1.11 09/13/09
<ul>
<li>More code clean up and another increase in speed.</li>
<li>Also port_report can now follow EtherChannel</li>
<li>Fixed issue, where the matching of the cdp neighbor was not matching correctly</li>
<li>Added better verbosity</li>
<li>Added Sanity Checking for cdp neighbors</li>
</ul>
<p>Revision 1.10 09/09/09</p>
<ul>
<li>Code Clean up and a slight increase in speed ( by a few seconds ) during the search by mac or ip</li>
</ul>
<p>Revision 1.9<br />
Code changes and Added CDP Support</p>
<ul>
<li>Detect CDP Neighbors during the scan for MAC Addresses or IP Addresses</li>
</ul>
<p>Revision 1.8<br />
Here is a quick update.....</p>
<ul>
<li>I just add dns reverse lookups to the output of this script.</li>
</ul>
<p>Revision 1.7<br />
Adds support to the following devices..</p>
<ol>
<li>Cisco
<ul>
<li>Catalyst 6509 w/ Supervisor 720 running IOS</li>
<li>Catalyst 3560</li>
<li>Catalyst 3550 (SMI)</li>
<li>Cisco CIGESM series Chassis Blades</li>
<li>Cisco Catalyst 2960</li>
</ul>
</li>
<li>Foundry
<ul>
<li>Foundry Server Iron</li>
</ul>
</li>
<li>Nortel
<ul>
<li>Nortel Passport 8600</li>
<li>Nortel 5520 Ethernet Routing Switch</li>
</ul>
</li>
<li>HP
<ul>
<li>HP Procurve 5406xl</li>
</ul>
</li>
</ol>
<p>&nbsp;</p>
<p>Revision 1.6<br />
New additions to this revision ....</p>
<ul>
<li>Support for HP Procurve Switches, ( Tested on the newer versions of HP )</li>
<li>combined switch_report.py in port_report.py.</li>
<li>Added --verbose flag</li>
</ul>
<p>Previous Releases....</p>
<ul>
<li>Search by MAC or IP or PORT</li>
</ul>
<p>&nbsp;</p>
<p>LD Port Reporter == {filelink=15}</p>
</dd>
</dl>
</div>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2009-09-10T23:57:18-04:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/cisco/snmp/howto-get-cdp-neighbor-information-through-python-and-snmp/">September 10, 2009</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/cisco/snmp/howto-get-cdp-neighbor-information-through-python-and-snmp/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~4 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/cisco/snmp/howto-get-cdp-neighbor-information-through-python-and-snmp/" rel="bookmark" title="HowTo get CDP neighbor information through Python and SNMP" itemprop="url">HowTo get CDP neighbor information through Python and SNMP</a></h1>
    
  </header>
  <div class="entry-content">
    <div>This new script is for Network Engineers and System Engineers a like. Though I must admit it is more for the System Engineers who do not have access to the command line on the CDP enabled device. Have you ever wanted to know what CDP enabled devces ( and info related to those devices ) that were directly connected to your your Core Switch? But you just do not have the access to get that info. But you do have access to the monitoring system, which has SNMP access to the Core Switch.</div>
<p><code>Well this is where my script comes into play... Stay tuned for updates, as I'm planning on adding to this script. So you can run it with the detail option and a detail port option. Please post any support related question in the forums here..</code><a href="forums/Scripting/scripting/sh_cdp_neighbor_help">http://www.linuxdynasty.org/forums/Scripting/scripting/sh_cdp_neighbor_help</a></p>
<div>Revision 1.2 9/13/2009</div>
<ul>
<li>Catch all CDP connected switches, even if there is more then 1 switch seen through 1 port.</li>
</ul>
<p>Revision 1.1 9/11/2009</p>
<ul>
<li>Added --type option ( --type=detail )</li>
</ul>
<div>Revision 1.0 9/10/2009</div>
<div>
<ul>
<li>This script is the equivalent of sho cdp nei on a cisco switch, but this is using snmp.</li>
</ul>
</div>
<pre><code>When you log into a switch and run a show cdp neighbor, your info might look a little like this.. <strong><span style="color: #0000ff;">show cdp neighbor</span></strong>Capability Codes: R - Router, T - Trans Bridge, B - Source Route Bridge S - Switch, H - Host, I - IGMP, r - Repeater, P - Phone Device ID Local Intrfce Holdtme Capability Platform Port ID71_5th_SW1 Gig 10/15 145 S I WS-C2960G-Gig 0/48D_M1001_V180_SW1 Gig 1/42 132 S I WS-C2960G-Gig 0/1D_M1001_V181_SW1 Gig 1/46 136 S I WS-C2960G-Gig 0/1D_M1001_V181_SW2 Gig 1/47 166 S I WS-C2960G-Gig 0/1D_M1001_V180_SW3 Gig 1/43 147 S I WS-C2960G-Gig 0/1D_M1001_V181_SW3 Gig 1/48 158 S I WS-C2960G-Gig 0/1D_M1001_V180_SW2 Gig 1/41 141 S I WS-C2960G-Gig 0/1D_M1001_V181_SW4 Gig 1/44 179 S I WS-C2960G-Gig 0/1D_M1001_V180_SW4 Gig 1/40 145 S I WS-C3560G-Gig 0/1D_M701_V177_SW4 Gig 10/7 174 S I WS-C2970G-Gig 0/25D_M701_V177_SW1 Gig 10/6 154 S I WS-C2970G-Gig 0/25Router Gig 10/1 162 R S WS-C6513 Gig 9/9Router1 Gig 10/14 168 R S WS-C6513 Gig 9/1679_18th_Fl_SW1 Gig 10/12 174 S I WS-C2960G-Gig 0/48D_1700_V187_SW1 Gig 10/13 129 S I WS-C3560G-Gig 0/28D_1700_V187_SW3 Gig 10/10 146 S I WS-C2960G-Gig 0/48D_1700_V187_SW2 Gig 10/9 148 S I WS-C2960G-Gig 0/48D_522_V176_SW1 Gig 10/3 121 S I WS-C2970G-Gig 0/25D_522_V176_SW4 Gig 10/4 125 S I WS-C2970G-Gig 0/25D_CL001_V200_SW1 Gig 10/11 125 S I WS-C2960G-Gig 0/242W_4507R Gig 7/2 147 R S I WS-C4507R Gig 3/9</code></pre>
<p>Now this is how it will look if you run sh_cdp_neighbor.py script...</p>
<p><a id="more"></a><a id="more-82"></a></p>
<pre>python <span style="color: #0000ff;"><strong>sh_cdp_neighbor.py -d 192.168.1.1 -c public</strong></span>Capability Codes: R - Router, T - Trans Bridge, B - Source Route Bridge S - Switch, H - Host, I - IGMP, r - Repeater, P - PhoneDevice ID                  Local Interface      Capability           Platform                       Remote Interface    D_M1001_V181_SW3           Gi1/48               S I                  cisco WS-C2960G-48TC-L         GigabitEthernet0/1  Router1                    Gi10/14              R S                  cisco WS-C6513                 GigabitEthernet9/16 D_M1001_V181_SW1           Gi1/46               S I                  cisco WS-C2960G-48TC-L         GigabitEthernet0/1  D_M1001_V181_SW2           Gi1/47               S I                  cisco WS-C2960G-48TC-L         GigabitEthernet0/1  D_M1001_V181_SW4           Gi1/44               S I                  cisco WS-C2960G-48TC-L         GigabitEthernet0/1  D_M1001_V180_SW1           Gi1/42               S I                  cisco WS-C2960G-48TC-L         GigabitEthernet0/1  D_M1001_V180_SW3           Gi1/43               S I                  cisco WS-C2960G-48TC-L         GigabitEthernet0/1  D_M1001_V180_SW4           Gi1/40               S I                  cisco WS-C3560G-24PS           GigabitEthernet0/1  D_M1001_V180_SW2           Gi1/41               S I                  cisco WS-C2960G-48TC-L         GigabitEthernet0/1  71_5th_SW1                 Gi10/15              S I                  cisco WS-C2960G-48TC-L         GigabitEthernet0/48 2W_4507R                   Gi7/2                R S I                cisco WS-C4507R                GigabitEthernet3/9  D_1700_V187_SW2            Gi10/9               S I                  cisco WS-C2960G-48TC-L         GigabitEthernet0/48 D_CL001_V200_SW1           Gi10/11              S I                  cisco WS-C2960G-24TC-L         GigabitEthernet0/24 D_1700_V187_SW3            Gi10/10              S I                  cisco WS-C2960G-48TC-L         GigabitEthernet0/48 D_1700_V187_SW1            Gi10/13              S I                  cisco WS-C3560G-24PS           GigabitEthernet0/28 79_18th_Fl_SW1             Gi10/12              S I                  cisco WS-C2960G-48TC-L         GigabitEthernet0/48 D_522_V176_SW1             Gi10/3               S I                  cisco WS-C2970G-24TS-E         GigabitEthernet0/25 Router                     Gi10/1               R S                  cisco WS-C6513                 GigabitEthernet9/9  D_M701_V177_SW1            Gi10/6               S I                  cisco WS-C2970G-24TS-E         GigabitEthernet0/25 D_M701_V177_SW4            Gi10/7               S I                  cisco WS-C2970G-24TS-E         GigabitEthernet0/25 D_522_V176_SW4             Gi10/4               S I                  cisco WS-C2970G-24TS-E         GigabitEthernet0/25</pre>
<p>As you can see I was able to get about 99% of what the command line version of <span style="color: #0000ff;"><strong>show cdp neighbor</strong></span> was able to retrieve.<br />
Here is another example of the newest feature.....</p>
<pre>python sh_cdp_neighbor.py -d 192.168.1.1 -c public --type=detail
------------------------------
Device ID: Network_5Entry address(es):
IP address:  192.186.1.15Platform: cisco WS-C2950T-24,  Capabilities: S IInterface: Gi3/16,
Port ID (outgoing port): GigabitEthernet0/1
Version :Cisco Internetwork Operating System SoftwareIOS (tm) C2950 Software (C2950-I6K2L2Q4-M), Version 12.1(22)EA11, RELEASE SOFTWARE (fc2)Copyright (c) 1986-2008 by cisco Systems, Inc.Compiled Tue 08-Jan-08 11:12 by amvarmaVTP
Management Domain: testDuplex: fullDuplexManagement address(es):
Â IP address:  192.186.1.15

------------------------------

------------------------------
Device ID: I_811_V53_SW1Entry address(es):
Â IP address:  192.186.1.16Platform: cisco WS-C2970G-24TS-E,  Capabilities: S IInterface: Gi9/1,
Â Port ID (outgoing port): GigabitEthernet0/25</pre>
<p>As you can see I was able to get about 99% of what the command line version of <span style="color: #0000ff;"><strong>show cdp neighbor detail</strong></span> was able to retrieve.</p>
<div>You will need the two python modules to run this script. which are pysnmp and pyasn1.<br />
To make your life easier you should do the following...</div>
<ol>
<li>install <a title="title" href="http://pypi.python.org/pypi/setuptools">python-setuptools<br />
</a></li>
<li>then run easy_install pysnmp</li>
<li>and easy_install pyasn1</li>
<li>or you can download the 2 modules manually.<br />
<a title="title" href="http://voxel.dl.sourceforge.net/sourceforge/pysnmp/pysnmp-4.1.10a.tar.gz">pysnmp</a> and <a title="title" href="http://voxel.dl.sourceforge.net/sourceforge/pyasn1/pyasn1-0.0.8a.tar.gz">pyasn1</a></li>
<li>then unzip the 2 files and in each directory run <strong>python setup.py install</strong></li>
</ol>
<p>I am using the following revisions from the python cheese shop pysnmp 4.1.7a and pyasn1 0.0.6</p>
<p>You can download the script here... <a href="View-details/LinuxDynasty/48-Show-CDP-Neighbor-using-SNMP-and-Python.html">sho_cdp_neighbor.py</a><br />
{filelink=16}</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2009-08-28T15:05:51-04:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/clustering/howto-monitor-redhat-cluster-using-snmp-and-python/">August 28, 2009</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://linuxdynasty.github.io/Linuxdynasty/clustering/howto-monitor-redhat-cluster-using-snmp-and-python/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~5 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/clustering/howto-monitor-redhat-cluster-using-snmp-and-python/" rel="bookmark" title="HowTo monitor RedHat Cluster using snmp and python" itemprop="url">HowTo monitor RedHat Cluster using snmp and python</a></h1>
    
  </header>
  <div class="entry-content">
    <p>Now that I am done with the implementation of RHE Cluster with GFS2, I now need to setup monitoring. As you all know, monitoring is a vital part of any environment. Even though we have a cluster of nodes setup, we still need to be aware of what is happening. Currently here are 2 very important tools, for checking the cluster status.</p>
<p><span style="color: #0000ff;"><strong>clustat</strong> </span> ( which is installed by the rgmanager rpm ) The clustat command will give you a quick status about all the nodes in the cluster and of the services running.<br />
<span style="color: #0000ff;"><strong>cman_tool</strong></span> ( which is installed by the cman rpm ) The cman_tool command is for managing a node in the cluster ( leaving, joining, votes, and status ).</p>
<p>Here is an example of <span style="color: #0000ff;"><strong>clustat</strong></span>...</p>
<pre><code>clustat Cluster Status for MyCluster @ Sat Aug 29 18:37:27 2009Member Status: Quorate Member Name ID Status ------ ---- ---- ------ gfs1 1 Online, Local, rgmanager gfs2 2 Online, rgmanager gfs3 3 Online, rgmanager /dev/disk/by-path/pci-0000:00:11.0-scsi-0:0:1:0-part1 0 Online, Quorum Disk Service Name Owner (Last) State ------- ---- ----- ------ ----- service:CIM gfs1 started service:Pirahna (gfs2) disabled</code></pre>
<p>&nbsp;</p>
<p><a id="more"></a><a id="more-218"></a></p>
<p>Here is an example of the <span style="color: #0000ff;"><strong>cman_tool</strong></span> command...</p>
<pre>cman_tool statusVersion: 6.1.0Config Version: 39Cluster Name: MyClusterCluster Id: 46516Cluster Member: YesCluster Generation: 392Membership state: Cluster-MemberNodes: 3Expected votes: 5Quorum device votes: 2Total votes: 5Quorum: 3  Active subsystems: 10Flags: Dirty Ports Bound: 0 11 177  Node name: gfs1Node ID: 1Multicast addresses: 239.192.181.106 Node addresses: 192.168.101.100</pre>
<p>As you noticed above, the information you get from both commands are extremely useful. The issue is that if you want the information from <span style="color: #0000ff;"><strong>clustat</strong></span> or <span style="color: #0000ff;"><strong>cman_tool</strong></span>, you will have to run those commands on a node that is part of the cluster. The reason this is an issue to me, is because I do not want to be burdened with sshing into one of the nodes anytime I want to know the status of the cluster. I want to be able to get that info directly from my desktop or from my monitoring system. After some research I discovered that there is a package called cluster-snmp that is part fo the yum "Clustering" Group.</p>
<p>This was exactly what I was looking for! A way to monitor or check the status of my cluster with out ssh. The next step is to configure cluster-snmp so that we can use it..<br />
<span class="note">NOTE... please do the following commands on all the nodes in your cluster...</span></p>
<ol>
<li>yum install cluster-snmp</li>
<li>vi /etc/snmp/snmpd.conf<br />
If your nodes are 32bit, add this into the file
<pre class="jive-pre"><code class="jive-code">dlmod RedHatCluster /usr/lib/cluster-snmp/libClusterMonitorSnmp.soview systemview included REDHAT-CLUSTER-MIB:RedHatCluster</code></pre>
<p>Or if your nodes are 64bit, add this into the file</p>
<pre class="jive-pre"><code class="jive-code">dlmod RedHatCluster /usr/lib64/cluster-snmp/libClusterMonitorSnmp.soview systemview included REDHAT-CLUSTER-MIB:RedHatCluster</code></pre>
</li>
<li>restart snmpd ( service snmpd restart )</li>
<li>Now do a snmpwalk... Example below..
<pre>snmpwalk -v2c -c public  localhost REDHAT-CLUSTER-MIB::RedHatCluster</pre>
<pre>REDHAT-CLUSTER-MIB::rhcMIBVersion.0 = INTEGER: 1REDHAT-CLUSTER-MIB::rhcClusterName.0 = STRING: "MyCluster"REDHAT-CLUSTER-MIB::rhcClusterStatusCode.0 = INTEGER: 4REDHAT-CLUSTER-MIB::rhcClusterStatusDesc.0 = STRING: "Some services not running"REDHAT-CLUSTER-MIB::rhcClusterVotesNeededForQuorum.0 = INTEGER: 3REDHAT-CLUSTER-MIB::rhcClusterVotes.0 = INTEGER: 5REDHAT-CLUSTER-MIB::rhcClusterQuorate.0 = INTEGER: 1REDHAT-CLUSTER-MIB::rhcClusterNodesNum.0 = INTEGER: 3REDHAT-CLUSTER-MIB::rhcClusterNodesNames.0 = STRING: "gfs1, gfs2, gfs3"REDHAT-CLUSTER-MIB::rhcClusterAvailNodesNum.0 = INTEGER: 3REDHAT-CLUSTER-MIB::rhcClusterAvailNodesNames.0 = STRING: "gfs1, gfs2, gfs3"REDHAT-CLUSTER-MIB::rhcClusterUnavailNodesNum.0 = INTEGER: 0REDHAT-CLUSTER-MIB::rhcClusterUnavailNodesNames.0 = ""REDHAT-CLUSTER-MIB::rhcClusterServicesNum.0 = INTEGER: 2REDHAT-CLUSTER-MIB::rhcClusterServicesNames.0 = STRING: "Pirahna, CIM"REDHAT-CLUSTER-MIB::rhcClusterRunningServicesNum.0 = INTEGER: 1REDHAT-CLUSTER-MIB::rhcClusterRunningServicesNames.0 = STRING: "CIM"REDHAT-CLUSTER-MIB::rhcClusterStoppedServicesNum.0 = INTEGER: 1REDHAT-CLUSTER-MIB::rhcClusterStoppedServicesNames.0 = STRING: "Pirahna"REDHAT-CLUSTER-MIB::rhcClusterFailedServicesNum.0 = INTEGER: 0REDHAT-CLUSTER-MIB::rhcClusterFailedServicesNames.0 = ""REDHAT-CLUSTER-MIB::rhcNodeName."gfs1" = STRING: "gfs1"REDHAT-CLUSTER-MIB::rhcNodeName."gfs2" = STRING: "gfs2"REDHAT-CLUSTER-MIB::rhcNodeName."gfs3" = STRING: "gfs3"REDHAT-CLUSTER-MIB::rhcNodeStatusCode."gfs1" = INTEGER: 0REDHAT-CLUSTER-MIB::rhcNodeStatusCode."gfs2" = INTEGER: 0REDHAT-CLUSTER-MIB::rhcNodeStatusCode."gfs3" = INTEGER: 0REDHAT-CLUSTER-MIB::rhcNodeStatusDesc."gfs1" = STRING: "Participating in cluster"REDHAT-CLUSTER-MIB::rhcNodeStatusDesc."gfs2" = STRING: "Participating in cluster"REDHAT-CLUSTER-MIB::rhcNodeStatusDesc."gfs3" = STRING: "Participating in cluster"REDHAT-CLUSTER-MIB::rhcNodeRunningServicesNum."gfs1" = INTEGER: 1REDHAT-CLUSTER-MIB::rhcNodeRunningServicesNum."gfs2" = INTEGER: 0REDHAT-CLUSTER-MIB::rhcNodeRunningServicesNum."gfs3" = INTEGER: 0REDHAT-CLUSTER-MIB::rhcNodeRunningServicesNames."gfs1" = STRING: "CIM"REDHAT-CLUSTER-MIB::rhcNodeRunningServicesNames."gfs2" = ""REDHAT-CLUSTER-MIB::rhcNodeRunningServicesNames."gfs3" = ""REDHAT-CLUSTER-MIB::rhcServiceName."CIM" = STRING: "CIM"REDHAT-CLUSTER-MIB::rhcServiceName."Pirahna" = STRING: "Pirahna"REDHAT-CLUSTER-MIB::rhcServiceStatusCode."CIM" = INTEGER: 0REDHAT-CLUSTER-MIB::rhcServiceStatusCode."Pirahna" = INTEGER: 1REDHAT-CLUSTER-MIB::rhcServiceStatusDesc."CIM" = STRING: "running"REDHAT-CLUSTER-MIB::rhcServiceStatusDesc."Pirahna" = STRING: "stopped"REDHAT-CLUSTER-MIB::rhcServiceStartMode."CIM" = STRING: "automatic"REDHAT-CLUSTER-MIB::rhcServiceStartMode."Pirahna" = STRING: "automatic"REDHAT-CLUSTER-MIB::rhcServiceRunningOnNode."CIM" = STRING: "gfs1"</pre>
</li>
</ol>
<p>As you can see you get a wealth of information from SNMP, though it is not all the information you need, but it has about 90% of what is important... So I decided to massage the data I get from snmp and create my own <a href="View-details/LinuxDynasty/45-clustat_snmp.py.html"><span style="color: #0000ff;"><strong>clustat_snmp.py</strong></span></a> command and my own <span style="color: #0000ff;"><strong><a href="View-details/Clustering-Tools/46-rh_cluster_check.py.html">rhe_cluster_check.py</a> </strong></span>. One command is to behave some what like the clustat utility and the other command is to check the status of your cluster through snmp, for monitoring systems like Nagios and Zenoss.</p>
<p>clustat_snmp.py =={filelink=17}<br />
Here is an example of the output you will get from<a href="View-details/LinuxDynasty/45-clustat_snmp.py.html"><span style="color: #0000ff;"><strong> clustat_snmp.py</strong></span>..</a></p>
<p><small>clustat_snmp.py -d gfs1 -c publicCluster Status for MyCluster @ Fri Aug 28 11:59:40 2009Member Status: QuorateTotal Nodes: 3Total Votes: 5Votes Needed For Quorum: 3</small><small> Member Name Status ------ ---- ------ gfs1 Participating in cluster gfs2 Participating in cluster gfs3 Participating in cluster Service Name Owner State Start Up Mode ------- ---- ----- ----- ------------- Pirahna stopped automatic CIM gfs1 running automatic</small></p>
<p>As you can see above, you get some of what the <span style="color: #0000ff;"><strong>clustat</strong></span> command gives you and some of what the <span style="color: #0000ff;"><strong>cman_tool status</strong></span> command gives you. But you get it all in one command through Python and Snmp. For both Python scripts you will need the two python modules. which are pysnmp and pyasn1.<br />
To make your life easier you should do the following...</p>
<ol>
<li>install <a title="title" href="http://pypi.python.org/pypi/setuptools">python-setuptools<br />
</a></li>
<li>then run easy_install pysnmp</li>
<li>and easy_install pyasn1</li>
<li>or you can download the 2 modules manually.<br />
<a title="title" href="http://voxel.dl.sourceforge.net/sourceforge/pysnmp/pysnmp-4.1.10a.tar.gz">pysnmp</a> and <a title="title" href="http://voxel.dl.sourceforge.net/sourceforge/pyasn1/pyasn1-0.0.8a.tar.gz">pyasn1</a></li>
<li>then unzip the 2 files and in each directory run <strong>python setup.py install</strong></li>
</ol>
<p>I am using the following revisions from the python cheese shop pysnmp 4.1.7a and pyasn1 0.0.6</p>
<p>The next command is the Nagios/Zenoss compatible <span style="color: #0000ff;"><strong>rh_cluster_check.py.</strong></span>..<br />
{filelink=18}<br />
Here is an example of the output you will get from rh_cluster_check.py..</p>
<pre>     python rh_cluster_check.py -d gfs1 -c public -t node -n gfs3      OK, gfs3 is Participating in cluster</pre>
<pre>      python rh_cluster_check.py -d gfs1 -c public -t service -s CIM      OK, CIM is running on gfs1</pre>
<pre>      python rh_cluster_check.py -d gfs2 -c public -t cluster      WARNING, MyCluster is Quorate and Some services not running

      python rh_cluster_check.py -d gfs1 -c public -t service -s Pirahna      CRITICAL, Pirahna is stopped</pre>
<p>The above command will allow you to check your cluster information by the means of pysnmp. You can check on the status of a particular node, the status of the cluster, and the status of a service.</p>
<p>&nbsp;</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->


<div class="pagination">
  
    
      <a href="http://linuxdynasty.github.io/Linuxdynasty/page6" class="btn">Previous</a>
    
  
  <ul class="inline-list">
    <li>
      
        <a href="http://linuxdynasty.github.io/Linuxdynasty">1</a>
      
    </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page2">2</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page3">3</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page4">4</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page5">5</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page6">6</a>
        
      </li>
    
      <li>
        
          <span class="current-page">7</span>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page8">8</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page9">9</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page10">10</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page11">11</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page12">12</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page13">13</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page14">14</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page15">15</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page16">16</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page17">17</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page18">18</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page19">19</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page20">20</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page21">21</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page22">22</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page23">23</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page24">24</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page25">25</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page26">26</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page27">27</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page28">28</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page29">29</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page30">30</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page31">31</a>
        
      </li>
    
  </ul>
  
    <a href="http://linuxdynasty.github.io/Linuxdynasty/page8" class="btn">Next</a>
  
</div><!-- /.pagination -->

</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 Allen Sanabria. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://linuxdynasty.github.io/Linuxdynasty/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://linuxdynasty.github.io/Linuxdynasty/assets/js/scripts.min.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2333243-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>

          

</body>
</html>