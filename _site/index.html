<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Latest Posts &#8211; Linuxdynasty</title>
<meta name="description" content="What I am up too.">
<meta name="keywords" content="Python, GoLang, automation, scripting, programming, vFense, metrics, monitoring">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://linuxdynasty.github.io/Linuxdynasty/images/abstract-1.jpg">

<meta name="twitter:title" content="Latest Posts">
<meta name="twitter:description" content="What I am up too.">
<meta name="twitter:creator" content="@linuxdynasty">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Latest Posts">
<meta property="og:description" content="What I am up too.">
<meta property="og:url" content="http://linuxdynasty.github.io/Linuxdynasty/index.html">
<meta property="og:site_name" content="Linuxdynasty">





<link rel="canonical" href="http://linuxdynasty.github.io/Linuxdynasty/">
<link href="http://linuxdynasty.github.io/Linuxdynasty/feed.xml" type="application/atom+xml" rel="alternate" title="Linuxdynasty Feed">
<link rel="author" href="https://google.com/+AllenSanabria?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://linuxdynasty.github.io/Linuxdynasty/assets/css/main.min.css">
<!-- Webfonts -->
<link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://linuxdynasty.github.io/Linuxdynasty/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://linuxdynasty.github.io/Linuxdynasty/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://linuxdynasty.github.io/Linuxdynasty/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://linuxdynasty.github.io/Linuxdynasty/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://linuxdynasty.github.io/Linuxdynasty/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://linuxdynasty.github.io/Linuxdynasty/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://linuxdynasty.github.io/Linuxdynasty/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://linuxdynasty.github.io/Linuxdynasty">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://linuxdynasty.github.io/Linuxdynasty/images/avatar.jpg" alt="Allen Sanabria photo" class="author-photo">
					<h4>Allen Sanabria</h4>
					<p>DevOps developer who loves programming, monitoring, automation, and metrics.</p>
				</li>
				<li><a href="http://linuxdynasty.github.io/Linuxdynasty/about/">Learn More</a></li>
				<li>
					<a href="mailto:asanabria <@> linuxdynasty dot org"><i class="fa fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="http://twitter.com/linuxdynasty"><i class="fa fa-twitter"></i> Twitter</a>
				</li>
				
				<li>
					<a href="https://google.com/+AllenSanabria"><i class="fa fa-google-plus"></i> Google+</a>
				</li>
				<li>
					<a href="http://linkedin.com/in/linuxdynasty"><i class="fa fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="http://github.com/linuxdynasty"><i class="fa fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://linuxdynasty.github.io/Linuxdynasty/posts/">All Posts</a></li>
				<li><a href="http://linuxdynasty.github.io/Linuxdynasty/tags/">All Tags</a></li>
			</ul>
		</li>
		<li><a href="http://linuxdynasty.github.io/Linuxdynasty"></a></li><li><a href="http://linuxdynasty.github.io/Linuxdynasty"></a></li>
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  <div class="image-credit">Image source: <a href="http://www.dargadgetz.com/ios-7-abstract-wallpaper-pack-for-iphone-5-and-ipod-touch-retina/">dargadgetz</a></div><!-- /.image-credit -->
  
    <div class="entry-image">
      <img src="http://linuxdynasty.github.io/Linuxdynasty/images/abstract-1.jpg" alt="Latest Posts">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Linuxdynasty</h1>
      <h2>Latest Posts</h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2014-09-26T00:00:00-04:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/graph-nginx-status-codes-in-graphite/">September 26, 2014</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/graph-nginx-status-codes-in-graphite/" rel="bookmark" title="Graph nginx status codes in Graphite." itemprop="url">Graph nginx status codes in Graphite.</a></h1>
    
  </header>
  <div class="entry-content">
    <p>I’m currently at the tail end of collecting metrics for the current company I work for.
We are using a combination of.</p>

<ul>
  <li><a href="http://sensuapp.org/">Sensu</a> (shipper)</li>
  <li><a href="http://graphite.wikidot.com/">Graphite</a>/<a href="https://github.com/etsy/statsd/">StatsD</a> (metrics handler)</li>
  <li><a href="http://grafana.org/">Grafana</a> (Beautiful Dashboards).</li>
</ul>

<p>I built a python script, that leverages the awesome tool <a href="http://linux.die.net/man/8/logtail">logtail</a>
in order to collect http status codes, without consuming too much cpu/ram.</p>

<p>I have tested this script against nginx logs and against 2 different formats (txt and json).</p>

<h3 id="download-script">Download Script</h3>

<ul>
  <li><a href="https://github.com/linuxdynasty/Linuxdynasty/blob/master/scripts/sensu/metrics/nginx-status-code-metrics.py">Nginx Status Code Metrics</a></li>
</ul>

<h3 id="basic-logging">Basic Logging</h3>
<div><div class="CodeRay">
  <div class="code"><pre>&quot;GET /test/foo HTTP/1.0&quot; 200 76288 &quot;-&quot; &quot;Ruby&quot;
</pre></div>
</div>
</div>

<h3 id="json-logging">Json Logging</h3>
<p>I printed the json on multiple lines, but in the log, the json is all in 1 line.</p>

<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2014-09-26T08:45:35-04:00&quot;</span><span class="p">,</span>
    <span class="nt">&quot;fields&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;remote_addr&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;remote_user&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="nt">&quot;body_bytes_sent&quot;</span><span class="p">:</span> <span class="s2">&quot;4823&quot;</span><span class="p">,</span>
        <span class="nt">&quot;request_time&quot;</span><span class="p">:</span> <span class="s2">&quot;0.127&quot;</span><span class="p">,</span>
        <span class="nt">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;200&quot;</span><span class="p">,</span>
        <span class="nt">&quot;request&quot;</span><span class="p">:</span> <span class="s2">&quot;POST /rubyamf_gateway/ HTTP/1.0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;request_method&quot;</span><span class="p">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
        <span class="nt">&quot;http_referrer&quot;</span><span class="p">:</span> <span class="s2">&quot;https://foo.bar.net/test/test&quot;</span><span class="p">,</span>
        <span class="nt">&quot;http_user_agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2062.124 Safari/537.36&quot;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>The only dependency of this script is logtail which you can install easily on any *nix system.</p>

<ul>
  <li>(Debian/Ubuntu) apt-get install logtail</li>
  <li>(CentOS/RedHat) yum install logtail</li>
</ul>

<p>If you do not have logtail installed you will get the following error</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">{</span>9:45<span class="o">}</span>~/Linuxdynasty/scripts/sensu/metrics:master ✓ python nginx-status-code-metrics.py -h
Please install logtail</code></pre></div>

<p>The following options are available</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">{</span>9:45<span class="o">}</span>~/Linuxdynasty/scripts/sensu/metrics:master ✓ ➭ python nginx-status-code-metrics.py -h
Options:
  -h, --help            show this <span class="nb">help </span>message and <span class="nb">exit</span>
  -d DIRECTORY, --directory<span class="o">=</span>DIRECTORY
                        The directory where the access logs exist
  -f FILE, --file<span class="o">=</span>FILE  name of the access log
  -t FILE_FORMAT, --file_format<span class="o">=</span>FILE_FORMAT
                        json or txt
  -s SCHEME, --scheme<span class="o">=</span>SCHEME
                        the metric naming scheme</code></pre></div>

<p>This is how you would run the script</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">{</span>9:45<span class="o">}</span>~/Linuxdynasty/scripts/sensu/metrics:master ✓ ➭ python nginx-status-code-metrics.py -d /var/log/nginx -f access.json -t json
webserver01.codes.200 <span class="m">1080</span> 1411736116.44
webserver01.codes.304 <span class="m">2</span> 1411736116.44
webserver01.codes.404 <span class="m">19</span> 1411736116.44</code></pre></div>

<p>The end result will look like this.
<img src="http://linuxdynasty.github.io/Linuxdynasty/assets/status_codes.png" alt="Grafana Screenshot" /></p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2014-09-23T00:00:00-04:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/migrated-from-wordpress-to-github-dot-io-pages/">September 23, 2014</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/migrated-from-wordpress-to-github-dot-io-pages/" rel="bookmark" title="Migrated from wordpress to github.io pages" itemprop="url">Migrated from wordpress to github.io pages</a></h1>
    
  </header>
  <div class="entry-content">
    <p>I just finished migrating from wordpress, and I love having the simplicity of 
just managing static pages and being able to edit them right from vim.
I will be updating my old posts little by little, so if a download link is not valid
than just check my <a href="https://github.com/linuxdynasty/Linuxdynasty">GitHub Page</a></p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2014-06-14T11:11:22-04:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/blog/years-silence/">June 14, 2014</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://linuxdynasty.github.io/Linuxdynasty/blog/years-silence/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/blog/years-silence/" rel="bookmark" title="Two years of silence" itemprop="url">Two years of silence</a></h1>
    
  </header>
  <div class="entry-content">
    <p>I have been so focused on vFense, that I have been negligent of this blog.
vFense has come a long way from it’s inception a little over 20 months ago.
We are still in the Beta, but we are continuously making improvements.
As of right now, I’m currently the only active developer working on the next
major release 0.8.0, which is a complete server rewrite. Examples of what is comming…</p>

<ul>
  <li>All functions, methods, and classes will be fully documented.</li>
  <li>Vulnerability correlation for the following operating systems…
    <ul>
      <li>RedHat and clones</li>
      <li>Ubuntu and clones</li>
      <li>Windows</li>
      <li>CVE/NVD</li>
    </ul>
  </li>
  <li>Moved to using <a href="https://linuxdynasty@bitbucket.org/linuxdynasty/apscheduler.git">APScheduler v3.1.0</a> for managing scheduled jobs</li>
  <li>Logging of all administrative tasks into RethinkDB.</li>
  <li>Remote command line tool for making API calls to vFense (Think of chef’s knife command)</li>
  <li>Token based authentication for the agents</li>
  <li>Separated WEB authentication from Agent authentication.</li>
</ul>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2012-03-20T03:37:52-04:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/redis/howto-check-redis-availability-stats-redis-py-zenoss-python/">March 20, 2012</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/redis/howto-check-redis-availability-stats-redis-py-zenoss-python/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~3 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/redis/howto-check-redis-availability-stats-redis-py-zenoss-python/" rel="bookmark" title="HowTo check redis availability and get stats using Redis-py, Zenoss, and Python" itemprop="url">HowTo check redis availability and get stats using Redis-py, Zenoss, and Python</a></h1>
    
  </header>
  <div class="entry-content">
    <p>My team was assigned to create a redis slave status check to be ran under Zenoss.
So while they are creating that check, I decided to google for redis checks
written in python that work under Nagios and or Zenoss and none of the checks
i found did exactly what I wanted.</p>

<p>So I decided to write my own check, that will grab every piece of data that the redis info() command was able to retrieve. Since this info is all in a python dictionary, I was able to get all the stats that were labeled as type int or as type float, which made my job that much easier.</p>

<p>So 1st I had to install 2 Redis instances on my local Ubuntu server at home. Now that i completed that, I had to make sure the slave was syncing off the master server. I used this link “<a title="Redis Replication Configuration" href="http://redis.io/topics/replication" target="_blank">http://redis.io/topics/replication</a>” to help me configure redis replication.
Now that all that stuff is out of the way, I wrote an easy_peasy python script to connect to redis and grab all of the performance stats. As well as verify if the instance is a master or a slave instance. If it is a slave instance, than it also verifies if it is syncing to the master or not.
The script is using <a href="https://github.com/andymccurdy/redis-py" target="_blank">Redis-py</a> that was installed using PIP.</p>

<p>Here is the script I wrote</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">godssoldier:python asanabria<span class="nv">$ </span>python ld_check_redis.py -d 127.0.0.1 -p <span class="s1">&#39;t35t_r3d15&#39;</span> -n 6379
OK Master Redis Server 127.0.0.1 is Running 2.4.4 <span class="p">|</span> <span class="nv">pubsub_channels</span><span class="o">=</span><span class="m">0</span> <span class="nv">bgrewriteaof_in_progress</span><span class="o">=</span>0
<span class="nv">connected_slaves</span><span class="o">=</span><span class="m">1</span> <span class="nv">uptime_in_days</span><span class="o">=</span><span class="m">0</span> <span class="nv">lru_clock</span><span class="o">=</span><span class="m">1099413</span> <span class="nv">last_save_time</span><span class="o">=</span><span class="m">1332199497</span> <span class="nv">redis_git_sha1</span><span class="o">=</span>0
<span class="nv">loading</span><span class="o">=</span><span class="m">0</span> <span class="nv">connected_clients</span><span class="o">=</span><span class="m">1</span> <span class="nv">keyspace_misses</span><span class="o">=</span><span class="m">4</span> <span class="nv">used_memory</span><span class="o">=</span><span class="m">939792</span> <span class="nv">vm_enabled</span><span class="o">=</span>0
<span class="nv">used_cpu_user_children</span><span class="o">=</span>0.000000 <span class="nv">used_memory_peak</span><span class="o">=</span><span class="m">939776</span> <span class="nv">total_commands_processed</span><span class="o">=</span>10
<span class="nv">latest_fork_usec</span><span class="o">=</span><span class="m">211</span> <span class="nv">used_memory_rss</span><span class="o">=</span><span class="m">1286144</span> <span class="nv">total_connections_received</span><span class="o">=</span><span class="m">8</span> <span class="nv">pubsub_patterns</span><span class="o">=</span>0
<span class="nv">aof_enabled</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_cpu_sys</span><span class="o">=</span>0.130000 <span class="nv">used_cpu_sys_children</span><span class="o">=</span>0.000000 <span class="nv">blocked_clients</span><span class="o">=</span>0
<span class="nv">used_cpu_user</span><span class="o">=</span>0.120000 <span class="nv">client_biggest_input_buf</span><span class="o">=</span><span class="m">0</span> <span class="nv">db0_keys</span><span class="o">=</span><span class="m">2</span> <span class="nv">db0_expires</span><span class="o">=</span><span class="m">0</span> <span class="nv">arch_bits</span><span class="o">=</span>64
<span class="nv">mem_fragmentation_ratio</span><span class="o">=</span>1.370000 <span class="nv">expired_keys</span><span class="o">=</span><span class="m">0</span> <span class="nv">evicted_keys</span><span class="o">=</span><span class="m">0</span> <span class="nv">bgsave_in_progress</span><span class="o">=</span>0
<span class="nv">client_longest_output_list</span><span class="o">=</span><span class="m">0</span> <span class="nv">process_id</span><span class="o">=</span><span class="m">22007</span> <span class="nv">uptime_in_seconds</span><span class="o">=</span><span class="m">401</span> <span class="nv">changes_since_last_save</span><span class="o">=</span>2
<span class="nv">redis_git_dirty</span><span class="o">=</span><span class="m">0</span> <span class="nv">keyspace_hits</span><span class="o">=</span>1

godssoldier:python asanabria<span class="nv">$ </span>python ld_check_redis.py -d 127.0.0.1 -p <span class="s1">&#39;t35t_r3d15&#39;</span> -n 6390
OK Master 127.0.0.1 is up and Slave 127.0.0.1 is in sync <span class="p">|</span> <span class="nv">pubsub_channels</span><span class="o">=</span><span class="m">0</span> <span class="nv">bgrewriteaof_in_progress</span><span class="o">=</span>0
<span class="nv">connected_slaves</span><span class="o">=</span><span class="m">0</span> <span class="nv">uptime_in_days</span><span class="o">=</span><span class="m">0</span> <span class="nv">lru_clock</span><span class="o">=</span><span class="m">1099413</span> <span class="nv">last_save_time</span><span class="o">=</span><span class="m">1332199497</span> <span class="nv">redis_git_sha1</span><span class="o">=</span>0
<span class="nv">loading</span><span class="o">=</span><span class="m">0</span> <span class="nv">connected_clients</span><span class="o">=</span><span class="m">2</span> <span class="nv">keyspace_misses</span><span class="o">=</span><span class="m">4</span> <span class="nv">used_memory</span><span class="o">=</span><span class="m">939872</span> <span class="nv">master_last_io_seconds_ago</span><span class="o">=</span>8
<span class="nv">vm_enabled</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_cpu_user_children</span><span class="o">=</span>0.000000 <span class="nv">used_memory_peak</span><span class="o">=</span><span class="m">931248</span> <span class="nv">total_commands_processed</span><span class="o">=</span>44
<span class="nv">latest_fork_usec</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_memory_rss</span><span class="o">=</span><span class="m">1277952</span> <span class="nv">total_connections_received</span><span class="o">=</span><span class="m">2</span> <span class="nv">pubsub_patterns</span><span class="o">=</span><span class="m">0</span> <span class="nv">aof_enabled</span><span class="o">=</span>0
<span class="nv">used_cpu_sys</span><span class="o">=</span>0.130000 <span class="nv">used_cpu_sys_children</span><span class="o">=</span>0.000000 <span class="nv">blocked_clients</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_cpu_user</span><span class="o">=</span>0.070000
<span class="nv">master_port</span><span class="o">=</span><span class="m">6379</span> <span class="nv">client_biggest_input_buf</span><span class="o">=</span><span class="m">0</span> <span class="nv">db0_keys</span><span class="o">=</span><span class="m">2</span> <span class="nv">db0_expires</span><span class="o">=</span><span class="m">0</span> <span class="nv">arch_bits</span><span class="o">=</span>64
<span class="nv">mem_fragmentation_ratio</span><span class="o">=</span>1.360000 <span class="nv">expired_keys</span><span class="o">=</span><span class="m">0</span> <span class="nv">evicted_keys</span><span class="o">=</span><span class="m">0</span> <span class="nv">bgsave_in_progress</span><span class="o">=</span><span class="m">0</span> <span class="nv">client_longest_output_list</span><span class="o">=</span>0
<span class="nv">master_sync_in_progress</span><span class="o">=</span><span class="m">0</span> <span class="nv">process_id</span><span class="o">=</span><span class="m">22010</span> <span class="nv">uptime_in_seconds</span><span class="o">=</span><span class="m">398</span> <span class="nv">changes_since_last_save</span><span class="o">=</span><span class="m">2</span> <span class="nv">redis_git_dirty</span><span class="o">=</span>0
<span class="nv">keyspace_hits</span><span class="o">=</span>0

CRITICAL Master 127.0.0.1 is down and Slave 127.0.0.1 is out of sync <span class="p">|</span>
<span class="nv">pubsub_channels</span><span class="o">=</span><span class="m">0</span> <span class="nv">bgrewriteaof_in_progress</span><span class="o">=</span><span class="m">0</span> <span class="nv">connected_slaves</span><span class="o">=</span><span class="m">0</span> <span class="nv">master_link_down_since_seconds</span><span class="o">=</span>1332199283
<span class="nv">uptime_in_days</span><span class="o">=</span><span class="m">0</span> <span class="nv">lru_clock</span><span class="o">=</span><span class="m">1099352</span> <span class="nv">last_save_time</span><span class="o">=</span><span class="m">1332198992</span> <span class="nv">redis_git_sha1</span><span class="o">=</span><span class="m">0</span> <span class="nv">loading</span><span class="o">=</span><span class="m">0</span> <span class="nv">connected_clients</span><span class="o">=</span>1
<span class="nv">keyspace_misses</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_memory</span><span class="o">=</span><span class="m">931040</span> <span class="nv">master_last_io_seconds_ago</span><span class="o">=</span>-1 <span class="nv">vm_enabled</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_cpu_user_children</span><span class="o">=</span>0.000000
<span class="nv">used_memory_peak</span><span class="o">=</span><span class="m">931040</span> <span class="nv">total_commands_processed</span><span class="o">=</span><span class="m">5</span> <span class="nv">latest_fork_usec</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_memory_rss</span><span class="o">=</span>1261568
<span class="nv">total_connections_received</span><span class="o">=</span><span class="m">6</span> <span class="nv">pubsub_patterns</span><span class="o">=</span><span class="m">0</span> <span class="nv">aof_enabled</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_cpu_sys</span><span class="o">=</span>0.080000
<span class="nv">used_cpu_sys_children</span><span class="o">=</span>0.000000 <span class="nv">blocked_clients</span><span class="o">=</span><span class="m">0</span> <span class="nv">used_cpu_user</span><span class="o">=</span>0.030000 <span class="nv">master_port</span><span class="o">=</span>6379
<span class="nv">client_biggest_input_buf</span><span class="o">=</span><span class="m">0</span> <span class="nv">arch_bits</span><span class="o">=</span><span class="m">64</span> <span class="nv">mem_fragmentation_ratio</span><span class="o">=</span>1.360000 <span class="nv">expired_keys</span><span class="o">=</span><span class="m">0</span> <span class="nv">evicted_keys</span><span class="o">=</span>0
 <span class="nv">bgsave_in_progress</span><span class="o">=</span><span class="m">0</span> <span class="nv">client_longest_output_list</span><span class="o">=</span><span class="m">0</span> <span class="nv">master_sync_in_progress</span><span class="o">=</span><span class="m">0</span> <span class="nv">process_id</span><span class="o">=</span>21887
<span class="nv">uptime_in_seconds</span><span class="o">=</span><span class="m">290</span> <span class="nv">changes_since_last_save</span><span class="o">=</span><span class="m">0</span> <span class="nv">redis_git_dirty</span><span class="o">=</span><span class="m">0</span> <span class="nv">keyspace_hits</span><span class="o">=</span>0</code></pre></div>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2011-12-30T22:26:23-05:00"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/monitor-rtsp-streaming-videos-openrtsp-zenoss/">December 30, 2011</a></time></span><span class="author vcard"><span class="fn"><a href="http://linuxdynasty.github.io/Linuxdynasty/about/" title="About Allen Sanabria">Allen Sanabria</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/monitor-rtsp-streaming-videos-openrtsp-zenoss/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://linuxdynasty.github.io/Linuxdynasty/python/zenoss/monitor-rtsp-streaming-videos-openrtsp-zenoss/" rel="bookmark" title="How To monitor RTSP streaming videos using openRTSP and Zenoss" itemprop="url">How To monitor RTSP streaming videos using openRTSP and Zenoss</a></h1>
    
  </header>
  <div class="entry-content">
    <p>Since I do currently work for a streaming company, that would imply that we should have some type of monitoring for our RTSP streams ;-). You will 1st need to get the openRTSP command.</p>
<ul>
<li>You will need to download the openRTSP command from http://www.live555.com/openRTSP/</li>
<li>Or if you are running Zenoss on top of Debian you can just run a apt-get install livemedia-utils</li>
</ul>
<p>Once you do that, all you have to do next is to download my script and have a valid server to point at and a path to test... Example below.. {filelink=24}</p>
<pre>./check_rtsp.py -d remote_server -p /iphone/2012 
OK /iphone/2012, test completed successfull against remote_server |status=0</pre>
<p>or with stats...</p>
<pre>./check_rtsp.py -d remote_server -p /iphone/2012 -s
OK /iphone/2012, test completed successfull against remote_server |status=0 num_packets_received=16 num_packets_lost=0 elapsed_measurement_time=3.000073 kBytes_received_total=16.309000 
measurement_sampling_interval_ms=1000 kbits_per_second_min=29.245485 kbits_per_second_ave=43.489608 
kbits_per_second_max=51.737449 packet_loss_percentage_min=0.000000 packet_loss_percentage_ave=0.000000 
packet_loss_percentage_max=0.000000 inter_packet_gap_ms_min=0.018000 inter_packet_gap_ms_ave=161.139313 
inter_packet_gap_ms_max=901.439000 subsession=video/H264 num_packets_received=61 num_packets_lost=0 
elapsed_measurement_time=3.000073 kBytes_received_total=27.630000 measurement_sampling_interval_ms=1000 
kbits_per_second_min=0.000000 kbits_per_second_ave=73.678207 kbits_per_second_max=122.923442 
packet_loss_percentage_min=0.000000 packet_loss_percentage_ave=0.000000 packet_loss_percentage_max=0.000000 
inter_packet_gap_ms_min=0.009000 inter_packet_gap_ms_ave=24.794672 inter_packet_gap_ms_max=528.923000</pre>
<p>So you can trend the different stats that openRTSP provides in Zenoss..</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->


<div class="pagination">
  
    Previous
  
  <ul class="inline-list">
    <li>
      
        <span class="current-page">1</span>
      
    </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page2">2</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page3">3</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page4">4</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page5">5</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page6">6</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page7">7</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page8">8</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page9">9</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page10">10</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page11">11</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page12">12</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page13">13</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page14">14</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page15">15</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page16">16</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page17">17</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page18">18</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page19">19</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page20">20</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page21">21</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page22">22</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page23">23</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page24">24</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page25">25</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page26">26</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page27">27</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page28">28</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page29">29</a>
        
      </li>
    
      <li>
        
          <a href="http://linuxdynasty.github.io/Linuxdynasty/page30">30</a>
        
      </li>
    
  </ul>
  
    <a href="http://linuxdynasty.github.io/Linuxdynasty/page2" class="btn">Next</a>
  
</div><!-- /.pagination -->

</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 Allen Sanabria. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://linuxdynasty.github.io/Linuxdynasty/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://linuxdynasty.github.io/Linuxdynasty/assets/js/scripts.min.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2333243-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>

          

</body>
</html>